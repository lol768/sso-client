<?xml version="1.0" encoding="UTF-8"?>

<project basedir="." default="deployjar" name="sso-client">

	

	<target name="init">

		<property name="srcDir" value="src" />
		<property name="buildDir" value="build" />
		<property name="buildName" value="sso-client" />
		<property name="jarFile" value="dist/${buildName}.jar"/>
		<property name="embeddedJarFile" value="dist/${buildName}-embedded.jar"/>		
		
		<path id="project.classpath">
			<fileset dir="external-libs">
				<include name="*.jar"/>
			</fileset>
			<fileset dir="${buildName}-jar/META-INF/lib">
				<include name="*.jar"/>
			</fileset>
		</path>

		<delete file="${jarFile}" />	
		
		<delete dir="${buildDir}" />

		<mkdir dir="${buildDir}/${buildName}-embedded-jar/"/>
		<mkdir dir="${buildDir}/${buildName}-jar/"/>

	</target>


	<target name="compile" depends="init">
		<javac destdir="${buildDir}/${buildName}-embedded-jar" excludes="" includes="" srcdir="${srcDir}" debug="true">
			<classpath refid="project.classpath" />
		</javac>
		<copy todir="${buildDir}/${buildName}-embedded-jar">
			<fileset dir="${buildName}-embedded-jar">
				<include name="**/*.*" />
			</fileset>
			<fileset dir="${srcDir}">
				<include name="**/*.xml"/>
			</fileset>
		</copy>
		
		
		<javac destdir="${buildDir}/${buildName}-jar" excludes="" includes="" srcdir="${srcDir}" debug="true">
				<classpath refid="project.classpath" />
		</javac>
		<copy todir="${buildDir}/${buildName}-jar">
			<fileset dir="${buildName}-jar">
				<include name="**/*.*" />
			</fileset>
			<fileset dir="${srcDir}">
				<include name="**/*.xml"/>
			</fileset>
		</copy>
	</target>

	
	<target name="buildjar" depends="compile">
		<jar destfile="${jarFile}" manifest="${buildName}-jar/META-INF/manifest.mf">
			<fileset dir="${buildDir}/${buildName}-jar/" />
		</jar>
	</target>
	
	<target name="buildembeddedjar" depends="compile">
		<jar destfile="${embeddedJarFile}" manifest="${buildName}-embedded-jar/META-INF/manifest.mf">
			<fileset dir="${buildDir}/${buildName}-embedded-jar/" />
		</jar>
		<copy todir="dist/dependencies">
			<fileset dir="${buildName}-jar/META-INF/lib">
				<include name="**/*.jar" />
			</fileset>
		</copy>
	</target>
	

	<target name="deployjar" depends="compile,buildjar,buildembeddedjar">
		<copy file="${jarFile}" todir="/apps/jboss-3.2.6/server/default/deploy/" />
	</target>



</project>